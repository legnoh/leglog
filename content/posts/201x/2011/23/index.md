---
title: 2011-23 / 東方幻想麻雀bot ver1.1公開 / アマレコTVでらいつべ幻麻配信
slug: 2011-23
author: Ryoma Kai
date: 2011-05-30
hero: ./images/20121230182329.jpeg
excerpt: 東方幻想麻雀bot ver1.1の更新内容をお伝えします。 / アマレコTVでらいつべ幻麻配信の設定手順を詳しく解説しました。
before_title: 東方幻想麻雀bot ver1.1公開
tags: []
---

挙がっていた細かい要望や個人的に欲しいなぁと思う所を色々修正しました。

## ①大会宣伝機能

**大会宣伝** or **大会告知** をつけたツイートをリプライで @thmjbot 宛に送ると、原文にツイート者の名前をつけて拡散します。

## ②卓立てにキーワードが必要に

間違ってリプライを飛ばす人が多かったので、特定のキーワードが入っていない場合、拡散を防止するようにしました。
殆どのテンプレは通ると思いますが、もし拡散が失敗した旨が返ってきた場合は、卓名や種類を簡単でいいので書いてみて下さい。

## ③本文コピー

鍵付きの方が募集する際、フォローしていない人から募集文面が見えなかったのと、
単純にクライアントの方が見辛いようだったので、拡散ツイートの部分に本文が入るようにしました。

## ④＠何人だけ見えるように

「＠何人」系の言葉を飛ばすと、その部分だけ強調した形でツイートしてくれます。
今のところ「微妙に見やすくなる」以上の特に深い意味はありません。

## ⑤URLを bit.ly で短縮

ツイート部分の本文URLをbit.lyで短縮するようにしました。本当は③を行ったので「@～」の形にしたいのですが、
基にしたソースの仕様上「@～」の部分を入れるのが困難だった為、ツイートのURLで代替えしています。

## ⑥卓抽選機能
@
thmjbotに「**どこ？**」とリプライを飛ばすと、全卓・全種類の中から卓抽選をしてくれます。(卓の種類・東半三)
少々変わりネタも入っていますので、気が乗らなかったら適当に無視してね！()

----

閑話休題。

しかしまぁ…GW挟んで本当に書くことが何も無かったとはいえ1ヶ月以上放置とか流石にダメだよね！アウトだよね！( ﾞ'ωﾞ` )

そんなこんなで今年度5月唯一の記事になりそうですが、特に5月病だとか経験している訳でもなく割と忙しく過ごしておりました。

やることが少なすぎてもつまらないけど、多すぎると逆に制限しなきゃいけないって悲しいよね。
多分少しずつ他のことも進めていくかと思いますので、またぼちぼち宜しくお願いします。

## 追記

発言の単語を拾う優先度が間違っていたので、いくらか再編集しました。


# 2011-23 / アマレコTVでらいつべ幻麻配信のまとめ

![](./images/20121230182329.jpeg)

今更これがかなりヤバいことに気付いたので自分用まとめ。

## メリット

- 元々ある取込み機能を使わないので幻麻が全然重くならない
    - 元々のだと初期設定の12fpsでも重いことがあるが30fpsが楽々通る
        - XPの古いPCとか回線が厳しい人でもこれなら配信できそう？
- SCFHからの取り込み＆H264での元々の取り込み機能より高画質
    - 名前欄の文字が潰れない
    - 画質自体は元々の画面取込みと大差ありませんが、フレームレート(fps)を安定して大幅に向上できるので、その影響で若干動画の質が良く見えます。
- 設定が細かく設定できる
    - モードや取り込み方を変えられる(この辺まだ色々見てる)
- ステレオミキサー(通称ステミキ)が無くても仮想ステミキでマイク＋BGMの配信ができる
- USBマイクやbluetoothヘッドセットもミキサーで扱える
- 「ステミキってなにー？」って人が配信を始める時に、ステミキを理解せずに直感的に音声ラインを扱える（多分）
- 結論：**これやばい**

## デメリット
- 配信時にアマレコTV・SCFH DSFを常時起動しておく必要がある(負荷は軽い)
- 設定が多すぎて迷う

デメリット自体は、とにかく **面倒** の一言です。

ただ、慣れの問題だと思うので、これから始める人や、障害が多かった人には個人的にかなりおススメです。
幻麻の配信なら以下の設定を真似て設定すれば30分くらい？で即導入できます。以下導入方法。


## 必要な物

- [アマレコTV](http://www.amarectv.com/top.html#amarectv)
    - AmaRecTV Live(↑の中にインストーラーが入ってます)
- [AMV2MT/AMV3 ビデオコーデック](https://www.vector.co.jp/soft/winnt/art/se460917.html)
- [SCFH DSF](http://mosax.sakura.ne.jp/yp4g/fswiki.cgi?page=SCFH+DSF)
    - アマレコTVに向かって通す
- livetubeクライアント(いつもの/公開終了)

## 手順

ひとまず全部インストール。管理者権限でやる方が無難。

らいつべクライアントがアマレコTV側に画面サイズを確認する際、どうやらPC起動後、初めてらいつべクライアントを起動したタイミングで行なっているようなので、アマレコTVの起動前にらいつべクライアントを立ち上げてしまった場合、一度PCをシャットダウンした方がよさそうです。

## アマレコTV

AmaRecTV.exeを起動し、設定画面を出して以下のように設定。SS無い所はそのままでおｋ
結構自己流でやってるのでデフォルトのままで良いものもあるかも。

### アマレコTV設定-グラフ1(デバイス)　タブ

![](./images/20121230182409.jpeg)

- フォーマットの **fps=60.00** に注意
- オーディオキャプチャデバイスは、 `AmaRec Core Audio Capture` の中から普段使っているスピーカーを選択します。ここは各人違うはずなので注意。

### アマレコTV設定-グラフ2(プレビュー)　タブ

![](./images/20121230182524.jpeg)

- アクション→動画に強く静画に弱い、全体的に荒い
- RPG→動画に弱く静画に強い、全体的にキメ細かい

という特徴があります。

麻雀は静止画の部分が多いので、ここはRPGを選びます。  
(本当はHWデインタレースが一番良いが、仕様上ライブでは使えない。録画ならこれが良い)


### アマレコTV設定-グラフ3(ライブ)　タブ

![](./images/20121230182555.jpeg)

### アマレコTV設定-録画設定　タブ

![](./images/20121230182621.jpeg)

- スペックや回線に余裕があれば、AMV2MTの設定を開いて、R1・R2等可逆圧縮のものにしてみるのもいいかも。


全て設定が終わったら「適用」→「OK」。一旦最小化します。

### 現ステミキ利用者の方に注意

- アマレコTV側でステミキを行わせると、 **BGMとマイクを入れても自分の声は自分に聞こえません。**
    - 全部アマレコTV側でやってくれるので、マイクミュートなどは再びつけておきましょう。
    - この2文の意味が分からない人はそもそも **ステミキの利用法が分かっていないor間違っている** 人なのでこのままステミキを使うつもりなら一度復習しましょう。今は良くても後々やらかすかもしれません。
    - [ステレオミキサーの基礎 - VIPで初心者がゲーム実況するには@ Wiki - アットウィキ](https://w.atwiki.jp/live2ch/pages/151.html#id_1411b06c)
- 当然ですが、ステミキとアマレコTV側のミキサーを併用するとカオスになってしまうので注意。

## SCFH DSF

アマレコTV・幻麻が開いた状態で、送信先を「AmaRecTV.exe」にし、後は通常通りに設定。
800×600で幻麻をオートで取りこめてればOKです。
自由画面で選んでもいいですが、その時は **4:3** の画面比率になるように選ぶことをお勧めします。

ここでアマレコTVに戻ってプレビュー画面を更新しましょう。

設定画面を一度開いて「OK」を押して閉じるorグラフっぽいボタンを一回押します。


## アマレコTV プレビュー画面

![](./images/20121230182652.jpeg)

こんな感じで、幻麻の画面が **綺麗に動いて見えれば** 設定完了。
**静止画になっていたり、画質が荒かったり、映らない** 場合は設定を見直しましょう。
また、プレビュー画面を引き延ばして、ステータスバーに「**Live[800x600 60.00fps 48kHz]**」の文字があることを確認してください。

プレビュー画面の音声テストは上手く動かないことが多いので、ミュートにしておきます。
実際どのように音声が入るかという点については、本来の機能である録画や、試験放送で確認しましょう。

## livetube.cc クライアント

- アマレコTV・SCFH DSF・幻想麻雀の3つが起動している状態で配信開始ボタンを押して起動。
-「ターゲット」タブで解像度を先に選んでおく。(640×480推奨)
- ソースに「AmaRec Video Capture」・「AmaRec Audio Capture」の２つを置いて、それぞれONにする。

![](./images/20121230182716.jpeg)

こんな感じで映ったら完了。後は配信開始でネットの海へー。(800×600の部分はその時見えた設定のままでOKです。)

全体的な注意点として、ソフトの設定を変えるとその度連携してるソフトを一々見直さないといけないかもしれないです。
連携が複雑なので、よく整理してから配信しましょう。

## おまけ

- 分からないことがある時は [マニュアル](http://www.amarectv.com/amarectv/manual.htm) も参考にしてみましょう。
    - ユーザーサポートは無いので、自分でどれだけ設定を仕込むか。
    - 正直動くならそれで十分。それ以上のメリットは薄いです。
- 疑問に感じている人がいると思うので少し補足すると、実際の配信映像のフレームレートは60fpsでは無く29.97fpsです。
    - 30fpsで設定すると、どうも相互に干渉し合っているのか上手く動作しなかった為、上記の設定に落ち着いています。
    - ダイアログなんかを見る限り30に変換する途中のフィルターが欠落してるorそんな設定を考慮されてない、とかそんな感じなのかな？
    - 現在は全部60fpsで設定してそのまま通してクライアントで処理させる、というやり方が一番しっくり嵌りそうですね。
- 「こんなでっけぇの投げて見る人バッファしねーのかよ」というところが1つ俺の疑問。
    - 多分らいつべクライアントがうまいことうまいこと頑張ってくれてるので大丈夫なんでしょう（思考放棄）。
- ミキサーって言ってるのにPC音(使わない)っておかしくね…？と思う人はいる筈(私も思った)。
    - 厳密には、グラフ1の所に設定させているのでここではPC音をカットしています。
    - こちらで設定させるならグラフ1の方を設定なしにすれば良いですが、それだと録画プレビューが正常に作動しないので、ローカルでの使い勝手を考えるとこの方が良いかなーと思いました。
    - 1本1本のオーディオデバイスが今**何の音を持っていてどこに渡しているか**一つ一つ考えてみましょう。
- 映像だけアマレコTVに任せたい時は、アマレコTV側のミキサー・オーディオデバイスに関する機能を一通り切って、ステミキだけ直接クライアントにのっければいいですね。
- TVゲームなんかを配信で取込む時は、「グラフ1(デバイス))　タブ」でSCFH DSFとAmaRecCoreAudioCaptureの代わりに使っているキャプチャーボードを選択するだけ。
    - 別ゲーの時は「グラフ2(プレビュー)　タブ」のアスペクト比は注意。PSPや最近のゲームなら16:9ですね。
- アマミキ！やアマレコTVのミキサー機能に関しては「これ将来ステミキ自体が不要になるよなぁ」と思えてならなかったので、ステミキの何たるかの理解って将来的に必要なくなるんじゃないかなぁと考えてしまう今日この頃です。
    - と言っても、アマレコTVの作者は「ステミキの利用法を最低限理解していてほしい」とのことなので、当面は **ステミキを使いこなせないと損をする**、という認識で良いのでしょう。
